<!DOCTYPE html>
<html>
<head>
    <title>Enigma Simulator</title>
    <style>
        body { font-family: 'Courier New', monospace; background: #222; color: #0f0; text-align: center; margin-top: 50px; }
        
        /* Beh친llaren f칬r maskinen */
        .machine-container {
            background: #333;
            width: 500px;
            margin: 0 auto;
            padding: 30px;
            border-radius: 15px;
            border: 2px solid #555;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.2);
        }

        img { width: 150px; height: 150px; margin-bottom: 20px; }
        
        /* Resultatrutan ser ut som en gammal sk칛rm */
        #displayScreen { 
            background: #000; 
            border: 4px solid #666; 
            color: #0f0; 
            padding: 20px; 
            font-size: 1.5em; 
            font-weight: bold; 
            min-height: 1.5em; 
            margin-bottom: 20px;
            word-wrap: break-word;
        }

        input { padding: 10px; font-size: 1em; width: 70%; margin-bottom: 10px; }
        
        button { padding: 10px 20px; font-size: 1.1em; cursor: pointer; margin: 5px; font-weight: bold; border-radius: 5px; }
        .lock-btn { background-color: #ff4444; color: white; border: none; }
        .unlock-btn { background-color: #44ff44; color: black; border: none; }

    </style>
</head>
<body>

    <div class="machine-container">
        <h1>ENIGMA MACHINE</h1>

        <img id="statusImage" src="locked.png" alt="Status">

        <div id="displayScreen">IFMMP!XPSME</div>
        
        <button class="unlock-btn" onclick="unlockMachine()">游댑 UNLOCK & DECRYPT</button>
        
        <hr style="border-color: #444; margin: 20px 0;">

        <p style="color: #aaa; font-size: 0.8em;">CREATE NEW SECRET:</p>
        <input type="text" id="inputText" placeholder="Write plain text here...">
        <br>
        <button class="lock-btn" onclick="lockMachine()">游 ENCRYPT & LOCK</button>
    </div>

    <script>
        // Funktion 1: L칀S UPP (Tar texten p친 sk칛rmen -> Avkrypterar)
        async function unlockMachine() {
            // H칛mta texten som visas just nu p친 "sk칛rmen"
            const currentText = document.getElementById('displayScreen').innerText;
            
            // Anropa API:et /decrypt
            const response = await fetch(`/decrypt?text=${encodeURIComponent(currentText)}`);
            const decryptedText = await response.text();

            // Uppdatera sk칛rmen
            document.getElementById('displayScreen').innerText = decryptedText;
            document.getElementById('displayScreen').style.color = "#44ff44"; // Gr칬n text

            // Byt bild till 칬ppen
            document.getElementById('statusImage').src = 'unlocked.png';
        }

        // Funktion 2: L칀S (Tar texten i input-rutan -> Krypterar)
        async function lockMachine() {
            // H칛mta texten fr친n input-rutan
            const textInput = document.getElementById('inputText').value;

            if (!textInput) {
                alert("Please write a message to encrypt first!");
                return;
            }

            // Anropa API:et /encrypt
            const response = await fetch(`/encrypt?text=${encodeURIComponent(textInput)}`);
            const encryptedText = await response.text();

            // L칛gg resultatet p친 stora sk칛rmen
            document.getElementById('displayScreen').innerText = encryptedText;
            document.getElementById('displayScreen').style.color = "#ff4444"; // R칬d text

            // Byt bild till l친st
            document.getElementById('statusImage').src = 'locked.png';

            // T칬m input-rutan f칬r effekt
            document.getElementById('inputText').value = "";
        }
    </script>
</body>
</html>